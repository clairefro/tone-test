{"version":3,"sources":["components/Tone.js","components/Player.js","App.js","index.js"],"names":["Tone","frequency","digit","active","className","Player","DIGIT_MAP","init","dist","arr","i","push","buildMap","BASE_FREQ","PLAY_ME_MAP","pi","Math","PI","phi","useState","tones","setTones","playMe","setPlayMe","toneSignal","setToneSignal","seq","setSeq","activeIndex","setActiveIndex","synth","useRef","ToneJS","toDestination","useEffect","a","mapDigitsToTones","emitToneChange","ts","stop","clear","resetActiveIndex","number","toString","replace","split","map","d","circularIndex","cirIndex","n","length","style","textAlign","margin","f","key","name","id","onChange","e","target","value","Object","keys","onClick","frequencies","t","time","freq","Date","toISOString","triggerAttackRelease","start","App","fontWeight","fontSize","href","rel","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6d7ba5a1.chunk.js","sourcesContent":["import React from \"react\";\n\nconst Tone = ({ frequency, digit, active }) => {\n  return <span className={active ? \"active\" : null}>{digit}</span>;\n};\n\nexport default Tone;\n","import React, { useState, useRef, useEffect } from \"react\";\nimport * as ToneJS from \"tone\";\n\nimport Tone from \"./Tone\";\n\nconst Player = () => {\n  const BASE_FREQ = 432;\n  const FREQ_DISTANCE = BASE_FREQ / 9;\n\n  const buildMap = (init, dist) => {\n    const arr = [];\n    for (let i = 0; i < 10; i++) {\n      if (i === 0) {\n        arr.push(init);\n      } else {\n        arr.push(arr[i - 1] + dist);\n      }\n    }\n    return arr;\n  };\n\n  const DIGIT_MAP = buildMap(BASE_FREQ, FREQ_DISTANCE);\n\n  const PLAY_ME_MAP = {\n    pi: Math.PI,\n    phi: 1.618033988749895,\n  };\n  const [tones, setTones] = useState([]);\n  const [playMe, setPlayMe] = useState(\"pi\");\n  const [toneSignal, setToneSignal] = useState(false);\n  const [seq, setSeq] = useState();\n  const [activeIndex, setActiveIndex] = useState(null);\n  const refFrequency = useRef();\n\n  const synth = new ToneJS.Synth().toDestination();\n  // useEffect(() => {\n  //   stop();\n  //   // if (tones.length > 0) {\n  //   //   play();\n  //   // }\n  // }, [tones]);\n\n  useEffect(() => {\n    setActiveIndex((a) => (a === null ? 0 : a + 1));\n  }, [toneSignal]);\n\n  useEffect(() => {\n    setTones(mapDigitsToTones(PLAY_ME_MAP[playMe]));\n  }, [playMe]);\n\n  // const addTone = () => {\n  //   const newTone = refFrequency.current.value;\n  //   setTones([...tones, newTone]);\n  // };\n\n  const play = () => {\n    const frequencies = tones.map((t) => t.frequency);\n\n    setSeq(\n      new ToneJS.Sequence((time, freq) => {\n        emitToneChange(new Date().toISOString());\n        synth.triggerAttackRelease(freq, 0.1);\n      }, frequencies).start()\n    );\n    ToneJS.Transport.start();\n  };\n\n  const emitToneChange = (ts) => {\n    setToneSignal(ts);\n  };\n\n  const stop = () => {\n    ToneJS.Transport.stop();\n    if (seq) {\n      seq.clear();\n    }\n    resetActiveIndex();\n  };\n\n  const resetActiveIndex = () => {\n    setActiveIndex(null);\n  };\n\n  const resetTones = () => {\n    setTones([]);\n  };\n\n  const clearTones = () => {\n    stop();\n    resetTones();\n    resetActiveIndex();\n  };\n\n  const mapDigitsToTones = (number) => {\n    if (number) {\n      const digits = number.toString().replace(/[.,-]/, \"\").split(\"\");\n      return digits.map((d) => ({ digit: d, frequency: DIGIT_MAP[d] }));\n    } else {\n      return;\n    }\n  };\n\n  const updatePlayMe = (e) => {\n    stop();\n    resetActiveIndex();\n    setPlayMe(e.target.value);\n  };\n\n  const circularIndex = (arr, cirIndex) => {\n    if (arr && cirIndex) {\n      const n = arr.length;\n      return ((cirIndex % n) + n) % n;\n    } else {\n      return false;\n    }\n  };\n\n  return (\n    <div>\n      <h3>DIGIT MAP</h3>\n      <p>Base frequency : {BASE_FREQ}Hz</p>\n      <p>\n        Interval : +{FREQ_DISTANCE}Hz ({BASE_FREQ}Hz / 9)\n      </p>\n      <table style={{ textAlign: \"left\", margin: \"0 auto\" }}>\n        <thead>\n          <tr>\n            <th>Digit</th>\n            <th>Frequency (Hz)</th>\n          </tr>\n        </thead>\n        <tbody>\n          {DIGIT_MAP.map((f, i) => (\n            <tr key={i}>\n              <td>{i}</td>\n              <td>{f}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n      <br />\n      <br />\n\n      <select name=\"play-me\" id=\"select-play-me\" onChange={updatePlayMe}>\n        {Object.keys(PLAY_ME_MAP).map((key, i) => (\n          <option value={key} key={i}>\n            {key}\n          </option>\n        ))}\n      </select>\n      <button onClick={play}>Play</button>\n      <button onClick={stop}>Stop</button>\n      <h2>Now playing:</h2>\n      <p>{`${playMe} : ${PLAY_ME_MAP[playMe]}`}</p>\n      <h2>Tones</h2>\n      {tones.length > 0\n        ? tones.map((t, i) => (\n            <Tone\n              frequency={t.frequency}\n              digit={t.digit}\n              key={i}\n              active={circularIndex(tones, activeIndex) === i}\n            />\n          ))\n        : \"no tones yet\"}\n    </div>\n  );\n};\n\nexport default Player;\n\n// <button onClick={clearTones}>Clear tones</button>\n// <button onClick={addTone}>Add tone</button>\n// <label htmlFor=\"frequency-input\">Frequency (Hz)</label>\n// <input type=\"number\" ref={refFrequency} id=\"frequency-input\" />\n","import React from \"react\";\nimport \"./styles/index.css\";\n\nimport Player from \"./components/Player\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Player />\n      <br />\n      <br />\n      <p style={{ fontWeight: \"normal\", fontSize: \"14px\" }}>\n        Background image by{\" \"}\n        <a\n          href=\"https://unsplash.com/photos/uhjiu8FjnsQ\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Unsplash\n        </a>\n      </p>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}